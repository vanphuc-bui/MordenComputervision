---
title: 'Chương 01'
date: 2022-12-25
permalink: /posts/2022/12/chapter-01/
tags:
  - Pytorch
---

## Cơ bản về mạng nơ-ron nhân tạo

Mạng nơ-ron nhân tạo (Artificial Neural Network - ANN) là một thuật toán học tập có giám sát được lấy cảm hứng từ cách thức hoạt động của bộ não con người. Tương tự như cách nơ-ron được kết nối và kích hoạt trong não người, mạng nơ-ron nhận đầu vào và chuyển nó qua hàm chức năng, dẫn đến một số nơ-ron tiếp theo được kích hoạt và do đó tạo ra đầu ra.

Có một số kiến trúc ANN tiêu chuẩn, định lý xấp xỉ phổ quát nói rằng luôn có thể tìm thấy một kiến trúc mạng nơ-ron đủ lớn với tập trọng số phù hợp để có thể dự đoán chính xác bất kỳ đầu ra nào cho bất kỳ đầu vào nào. Điều này có nghĩa là, đối với một tập dữ liệu/tác vụ nhất định, ta có thể tạo một kiến trúc và tiếp tục điều chỉnh trọng số của nó cho đến khi ANN dự đoán những gì mong muốn. Việc điều chỉnh các trọng số cho đến khi điều này xảy ra được gọi là huấn luyện mạng thần kinh.

Trong chương này, một kiến trúc rất đơn giản sẽ được xây dựng trên một tập dữ liệu đơn giản và chủ yếu tập trung vào cách các khối xây dựng khác nhau (feedforward, backpropagation, learning rate) của ANN giúp điều chỉnh trọng số để mạng học cách dự đoán kết quả đầu ra mong đợi từ các đầu vào đã cho. Trước tiên, ta sẽ tìm hiểu về mặt toán học mạng nơ-ron là gì, sau đó xây dựng một mạng từ đầu để có một nền tảng vững chắc. Sau đó sẽ tìm hiểu về từng thành phần chịu trách nhiệm huấn luyện mạng nơ-ron và viết code cho chúng. Những chủ đề sau sẽ được đề cập đến:

* So sánh trí tuệ nhân tạo (Artificial Intelligence - AI) và học máy truyền thống.
* Tìm hiểu về các khối xây dựng nên một ANN.
* Thực hiện feedforward propagation.
* Thực hiện backpropagation.
* Kết hợp feedforward propagation và backpropagation.
* Hiểu về sự ảnh hưởng của learning rate trong việc huấn luyện.
* Tóm tắt quá trình huấn luyện mạng nơ-ron.

### So sánh trí tuệ nhân tạo và học máy truyền thống

Theo truyền thống, các hệ thống thông minh được lập trình bằng cách sử dụng các thuật toán phức tạp do các lập trình viên viết ra.
Ví dụ: giả sử bạn muốn biết liệu một bức ảnh có chứa một con chó hay không. Trong máy học (Machine Learning - ML) truyền thống, trước tiên, một học viên ML hoặc chuyên gia về chủ đề sẽ xác định các đặc tính cần được trích xuất từ ​​hình ảnh. Sau đó, họ trích xuất các đặc điểm đó và chuyển chúng qua một thuật toán để giải mã các đặc điểm đã cho để cho biết hình ảnh là của một con chó hay không. Xem ví dụ dưới đây:
  <p align="center">
  <img src="/MordenComputervision/images/Chapter01/dog.png" style="width:50%; border:0;">
  </p>

Từ những hình ảnh trước, một quy tắc đơn giản có thể là nếu một hình ảnh chứa ba vòng tròn màu đen được xếp thành hình tam giác, thì nó có thể được phân loại là một con chó. Tuy nhiên, quy tắc này sẽ thất bại đối với cận cảnh lừa đảo này của một chiếc bánh muffin:
  <p align="center">
  <img src="/MordenComputervision/images/Chapter01/muffin.png" style="width:50%; border:0;">
  </p>

Tất nhiên, quy tắc này cũng không thành công khi hiển thị một hình ảnh có bất kỳ thứ gì khác ngoài khuôn mặt của một con chó cận cảnh. Do đó, đương nhiên, số lượng quy tắc thủ công cần tạo để phân loại chính xác nhiều loại có thể tăng theo cấp số nhân, đặc biệt là khi hình ảnh trở nên phức tạp hơn. Do đó, cách tiếp cận truyền thống hoạt động tốt trong môi trường rất hạn chế (ví dụ: chụp ảnh hộ chiếu trong đó tất cả các kích thước được giới hạn trong phạm vi milimet) và hoạt động kém trong môi trường không bị hạn chế, nơi mọi hình ảnh thay đổi rất nhiều.

Ta có thể mở rộng cùng một cách suy nghĩ cho bất kỳ bối cảnh nào, chẳng hạn như văn bản hoặc dữ liệu có cấu trúc. Trước đây, nếu ai đó quan tâm đến việc lập trình để giải quyết một nhiệm vụ trong thế giới thực, họ cần phải hiểu mọi thứ về dữ liệu đầu vào và viết càng nhiều quy tắc càng tốt để xử lý mọi tình huống. Điều này thật tẻ nhạt và không có gì đảm bảo rằng tất cả các kịch bản mới sẽ tuân theo các quy tắc đã nói.
Tuy nhiên, bằng cách tận dụng mạng nơ-ron nhân tạo, chúng ta có thể thực hiện điều này chỉ trong một bước.

Mạng nơ-ron cung cấp lợi ích trong việc kết hợp trích xuất đặc trưng và sử dụng các đặc trưng đó để phân loại/hồi quy. Cả hai nhiệm vụ con này chỉ yêu cầu dữ liệu được dán nhãn (ví dụ: ảnh nào là chó và ảnh nào không phải chó) và kiến trúc mạng nơ-ron. Nó không yêu cầu con người đưa ra các quy tắc để phân loại một hình ảnh, điều này giúp loại bỏ phần lớn gánh nặng mà các kỹ thuật truyền thống áp đặt lên người lập trình.

Lưu ý rằng yêu cầu chính là cần cung cấp một số lượng đáng kể số mẫu. Ví dụ, trong trường hợp trước, ta cần cung cấp rất nhiều hình ảnh về chó và không phải chó cho mô hình để mô hình học các đặc trưng. Một cái nhìn tổng qua về cách các mạng nơ-ron dùng cho nhiệm vụ phân loại (classification) như sau:
  <p align="center">
  <img src="/MordenComputervision/images/Chapter01/nn_classification.png" style="width:50%; border:0;">
  </p>
Như vây ta đã có được cái nhìn tổng quan về mạng nơ-ron nhân tạo. Các phần tiếp theo sẽ trình bày sâu hơn về cách thức hoạt động của một mạng nơ-ron nhân tạo.

### Tìm hiểu về các khối xây dựng nên một mạng nơ-ron nhân tạo

ANN là một tập hợp các tensor (trọng số) và các phép toán. Nó có thể được xem như một hàm toán học nhận một hoặc nhiều tensor đầu vào và dự đoán một hoặc nhiều tensor đầu ra. Việc sắp xếp các phép tính kết nối các đầu vào và đầu ra được gọi là kiến trúc của mạng nơ-ron. Chúng ta có thể tùy chỉnh kiến trúc của mạng nơ-ron dựa trên nhiệm vụ hiện tại. Một ANN được tạo thành từ những phần sau:

  * **Các lớp đầu vào**: Các lớp này lấy các biến độc lập làm đầu vào.
  * **Các lớp ẩn (trung gian)**: <p style='text-align: justify;'>Các lớp này kết nối các lớp đầu vào và đầu ra trong khi thực hiện các phép biến đổi trên đầu dữ liệu đầu vào. Hơn nữa, các lớp ẩn chứa các **nút** (vòng tròn trong sơ đồ sau) để biến đổi các giá trị đầu vào của chúng thành các giá trị có chiều cao hơn/thấp hơn. Chức năng để đạt được một biểu diễn phức tạp hơn đạt được bằng cách sử dụng các hàm kích hoạt khác nhau để biến đổi các giá trị của các nút của các lớp trung gian.</p>
  * **Lớp đầu ra**: Lớp này chứa các giá trị mà các biến đầu vào dự kiến sẽ tạo ra.

Với suy nghĩ này, cấu trúc điển hình của một mạng lưới thần kinh như sau:
  <p align="center">
  <img src="/MordenComputervision/images/Chapter01/nn.png" style="width:50%; border:0;">
  </p>

Số lượng nút của lớp đầu ra phụ thuộc vào nhiệm vụ đang thực hiện và việc chúng ta đang muốn dự đoán một biến liên tục hay một biến phân loại. Nếu đầu ra là một biến liên tục, đầu ra có một nút. Nếu đầu ra là phân loại với $m$ lớp, thì sẽ có $m$ nút trong lớp đầu ra. Một nơ-ron biến đổi đầu vào của nó như sau:
  <p align="center">
  <img src="/MordenComputervision/images/Chapter01/node.png" style="width:50%; border:0;">
  </p>

Ở sơ đồ trước, $x_1, x_2,\ldots, x_n$ là các biến đầu vào, và $w_0$ số hạng sai lệch (tương tự như cách chúng ta có sai lệch trong hồi quy tuyến tính).

Lưu ý rằng $w_1, w_2,\ldots, w_n$ là các trọng số được cung cấp cho mỗi biến đầu vào và $w_0$ là số hạng sai lệch. Giá trị đầu ra $a$ được tính như sau:

$$a = f\left(w_0 + \sum_{i=1}^nw_ix_i\right)$$
#### Header 2



